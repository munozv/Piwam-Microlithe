<?php
/**
 * MemberExtraRow
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    piwam
 * @subpackage model
 * @author     Adrien Mogenet
 * @version    SVN: $Id: Builder.php 7021 2010-01-12 20:39:49Z lsmith $
 */
class MemberExtraRow extends BaseMemberExtraRow
{
  /**
   * Return list of parameters as a list of choices. Allows to
   * check errors if any
   *
   * @return  arrau
   */
  public function getParametersAsChoices()
  {
    $list = $this->getParameters();
    $list = explode(',', $list);
    $result = array();

    foreach ($list as $choice)
    {
      $result[$choice] = $choice;
    }

    return $result;
  }

  /**
   * Return the parameter as an integer. Allows to
   * check errors if any
   */
  public function getParameterAsInt()
  {
    $original = $this->getParameters();
    $split = explode(' ', $original);

    if ((count($split) === 2) && (ctype_digit($split[1])))
    {
      return $split[1];
    }
    else
    {
      throw new sfException('Error when parsing type of extra
        row "' . $this->getLabel() . '"');
    }
  }

  /**
   * Automatically slugify the label
   *
   * @param   string          $value
   * @return  MemberExtraRow  $this
   */
  public function setLabel($value)
  {
    $this->_set('label', $value);
    $this->setSlug(StringTools::slugify($value));

    return $this;
  }

  /**
   * Pretty printable strings which describes the parameters
   *
   * @return  string
   * @todo    implements
   */
  public function getPrintableParameters()
  {
    return $this->_get('parameters');
  }

  /**
   * Get a frenchy displayable type
   *
   * @return  string
   * @todo    Use i18n mecanism ?
   */
  public function getCompleteType()
  {
    $types = MemberExtraRowTable::$types;
    
    return $types[$this->getType()];
  }
}
